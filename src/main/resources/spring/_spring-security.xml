<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:jee="http://www.springframework.org/schema/jee" xmlns:jpa="http://www.springframework.org/schema/data/jpa"
	xmlns:jdbc="http://www.springframework.org/schema/jdbc" xmlns:mvc="http://www.springframework.org/schema/mvc"
	xmlns="http://www.springframework.org/schema/security" xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="
http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context-3.0.xsd
http://www.springframework.org/schema/jee
http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
http://www.springframework.org/schema/jdbc 
http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd
http://www.springframework.org/schema/data/jpa
http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd
http://www.springframework.org/schema/data/repository
http://www.springframework.org/schema/data/repository/spring-repository-1.5.xsd
http://www.springframework.org/schema/mvc
http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.2.xsd
http://www.springframework.org/schema/tx
http://www.springframework.org/schema/tx/spring-tx-3.0.xsd"
	default-autowire="byName">

    <global-method-security secured-annotations="enabled" />
    
    <http auto-config="true">
		<!-- <session-management session-fixation-protection="migrateSession" /> -->
		<!-- Make sure you are not sending login/password in plain text on open 
			channel. Use SSL (https) instead -->
        <!-- Restrict URLs based on role -->
        <intercept-url pattern="/login*" access="IS_AUTHENTICATED_ANONYMOUSLY" requires-channel="https" />
        <!-- <intercept-url pattern="/logoutSuccess*" access="IS_AUTHENTICATED_ANONYMOUSLY" requires-channel="https" /> -->
        <!-- <intercept-url pattern="/css/main.css" access="IS_AUTHENTICATED_ANONYMOUSLY" requires-channel="https" /> -->
        <intercept-url pattern="/resources/**" access="IS_AUTHENTICATED_ANONYMOUSLY" requires-channel="https" />
		<!-- <intercept-url pattern="/user**" access="ROLE_USER" requires-channel="https" /> -->
		<intercept-url pattern="/admin**" access="ROLE_ADMIN" requires-channel="https" />
        <intercept-url pattern="/**" access="IS_AUTHENTICATED_ANONYMOUSLY" requires-channel="https" />
        <!-- Override default login and logout pages -->
   		<form-login
   			login-page="/login"
   			default-target-url="/user"
			authentication-failure-url="/login?error"
			username-parameter="username"
			password-parameter="password" />
		<!-- <logout logout-success-url="/login?logout" /> -->
		<!-- access denied page (mkyong) -->
		<access-denied-handler error-page="/403" />
		<!-- Spring security redirects default to https 8443 (zoetg00) -->
		<port-mappings>
			<port-mapping https="8181" http="8080" />
		</port-mappings>
	</http>

	<!-- authentication manager and password hashing -->
	<authentication-manager alias="authenticationManager">
		<authentication-provider ref="daoAuthenticationProvider" />
	</authentication-manager>

	<beans:bean id="daoAuthenticationProvider"
		class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
		<beans:property name="userDetailsService" ref="userDetailsService" />
		<!-- <beans:property name="saltSource"> <beans:bean class="org.springframework.security.authentication.dao.ReflectionSaltSource"> 
			<beans:property name="userPropertyToUse" value="username" /> </beans:bean> 
			</beans:property> <beans:property name="passwordEncoder" ref="passwordEncoder" 
			/> -->
	</beans:bean>

	<beans:bean id="userDetailsService" name="userAuthenticationProvider"
		class="nl.nofas.service.UserDetailsServiceNofas">
		<!-- <beans:constructor-arg index="0" ref="userRepository" /> -->
	</beans:bean>

	<beans:bean id="webexpressionHandler" class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler" />

	<!-- <beans:bean id="passwordEncoder"
		class="org.springframework.security.authentication.encoding.ShaPasswordEncoder">
		<beans:constructor-arg index="0" value="256" />
	</beans:bean> -->

</beans:beans>